<div class="full-width-flex-container">
  <div class="new-recipe-container">

    <form [formGroup]="recipeForm">
      <div class="recipe-form-container">
        <input autofocus class="ipt ipt-name" formControlName="name" type="text" [placeholder]="recipe.name" >

        <h3 class="header">
          Ingredients
        </h3>
        <ul>
          <li class="list-element" *ngFor="let product of recipe.ingredients; let i = index">
            <p class="ing-attr">{{product.name}} {{(product.quantity === 0) ? '' : product.quantity}} {{ product.unit }}</p>
            <div class="btns-container">
              <button class="btn" (click)="onDeleteIngClick(i)">Delete</button>
              <button class="btn" (click)="onEditIngClick(i)">Edit</button>
            </div>
          </li>

          <form [formGroup]="ingredientForm">
            <div class="ingredients-form-container">

              <div class="ingredients-inputs-container">
                <input #ing_name_input class="ipt ipt-product-name" formControlName="productName" type="text" placeholder="product Name">
                <input class="ipt ipt-product-qty" formControlName="productQuantity" type="text" placeholder="quantity">
                <input class="ipt ipt-product-unit" formControlName="productUnit" type="text" list="units" placeholder="unit">
                <datalist id="units">
                  <option *ngFor="let unit of units">{{ unit }}</option>
                </datalist>
              </div>

              <button [ngClass]="!ingredientForm.valid ? 'invalid' : ''" *ngIf="editingIngIndex === -1" class="btn btn-add-ing" (click)="onAddIngredient()" >Add Ingredient</button>
              <button [ngClass]="!ingredientForm.valid ? 'invalid' : ''" *ngIf="editingIngIndex !== -1" class="btn btn-add-ing" (click)="onSaveChangesClick()" >Save Changes</button>
            </div>
          </form>
        </ul>

        <h3 class="header">Preparation</h3>
        <ul>
          <li class="list-element" *ngFor="let step of recipe.prepSteps; let i = index">
            <p class="step">{{ step }}</p>
            <div class="btns-container">
              <button class="btn" (click)="onDeleteStepClick(i)">Delete</button>
              <button class="btn" (click)="onEditStepClick(i)">Edit</button>
            </div>
          </li>
          <form [formGroup]="stepForm">
            <div class="step-form-container">
              <input #step_input class="ipt" formControlName="step" type="text" placeholder="Preparation Step">
              <button [ngClass]="!stepForm.valid ? 'invalid' : ''" *ngIf="editingStepIndex === -1" class="btn btn-add-step" (click)="onAddStep()" >Add Step</button>
             <button  [ngClass]="!stepForm.valid ? 'invalid' : ''" *ngIf="editingStepIndex !== -1"class="btn btn-add-step" (click)="onSaveStepChangesClick()" >Save Changes</button>
            </div>
          </form>
        </ul>

        <h3 class="header">Optional Attributes</h3>

        <div class="opt-attr-container">
          <input
            class="ipt"
            formControlName="prepTime"
            id="prep-time"
            type="text"
            placeholder="Preparation Time"
          >

          <input
            class="ipt"
            formControlName="difficulty"
            id="difficulty"
            type="text"
            placeholder="difficulty"
          >

          <input
            class="ipt"
            formControlName="servings"
            id="servings"
            type="text"
            placeholder="servings"
          >

          <input
            class="ipt"
            formControlName="pricePerServing"
            id="price-per-serving"
            type="text"
            placeholder="Price Per Serving"
          >

          <input
            class="ipt description"
            formControlName="description"
            id="description"
            type="text"
            placeholder="description"
          >
        </div>

        <button *ngIf="!editMode" type="button" class="btn btn-add-recipe" (click)="onAddRecipe()">Add Recipe</button>
        <button *ngIf="editMode" type="button" class="btn btn-add-recipe" (click)="onSaveChanges(recipe)">Save Changes</button>

      </div>
    </form>
  </div>
</div>
